@model Arca.Shared.Models.Semilla

@{
    ViewBag.Title = "Agregar Semilla";
    // Asegura una fecha válida para el input date
    var fecha = (Model != null && Model.FechaAlmacenamiento != default(DateTime))
                ? Model.FechaAlmacenamiento
                : DateTime.Today;
}

<div class="form-container">
    <h1>Agregar Semilla</h1>

    @* Mensajes globales *@
    @if (TempData["Error"] != null)
    {
        <p style="color:red; text-align:center;">@TempData["Error"]</p>
    }
    @if (TempData["Mensaje"] != null)
    {
        <p style="color:green; text-align:center;">@TempData["Mensaje"]</p>
    }

    @* Resumen de validación *@
    @Html.ValidationSummary(excludePropertyErrors: true, message: "", htmlAttributes: new { @class = "text-danger", style = "text-align:center;" })

    @using (Html.BeginForm("Create", "Semilla", FormMethod.Post))
    {
        @Html.AntiForgeryToken()

        <label for="Nombre">Nombre:</label>
        @Html.TextBoxFor(m => m.Nombre, new { required = "required" })
        @Html.ValidationMessageFor(m => m.Nombre, "", new { @class = "text-danger" })

        <label for="EspecieId">Especie:</label>
        @Html.DropDownListFor(
            m => m.EspecieId,
            (SelectList)ViewBag.Especies,
            "-- Seleccione --",
            new { @class = "form-control", required = "required" })
        @Html.ValidationMessageFor(m => m.EspecieId, "", new { @class = "text-danger" })

        <label for="UbicacionId">Ubicación:</label>
        @Html.DropDownListFor(
            m => m.UbicacionId,
            (SelectList)ViewBag.Ubicaciones,
            "-- Seleccione --",
            new { @class = "form-control", required = "required" })
        @Html.ValidationMessageFor(m => m.UbicacionId, "", new { @class = "text-danger" })

        <label for="Cantidad">Cantidad:</label>
        @Html.TextBoxFor(m => m.Cantidad, new { type = "number", min = "0", required = "required" })
        @Html.ValidationMessageFor(m => m.Cantidad, "", new { @class = "text-danger" })

        <label for="FechaAlmacenamiento">Fecha de Almacenamiento:</label>
        <input type="date"
               id="FechaAlmacenamiento"
               name="FechaAlmacenamiento"
               value="@fecha.ToString("yyyy-MM-dd")"
               required />
        @Html.ValidationMessageFor(m => m.FechaAlmacenamiento, "", new { @class = "text-danger" })

        <div class="button-container" style="gap:12px; flex-wrap:wrap;">
            <button type="submit" class="button">Guardar</button>
            <a href="@Url.Action("Index", "Semilla")" class="button">Cancelar</a>
        </div>
    }
</div>
